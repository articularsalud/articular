<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=5.0">
    <meta name="description" content="FlexDol - Alivio natural para dolores articulares. ¬°50% de descuento hoy!">
    <title>FlexDol - Articulaciones Sanas 100% Natural</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-text-size-adjust: 100%;
            -moz-text-size-adjust: 100%;
            -ms-text-size-adjust: 100%;
        }

        html {
            font-size: 16px;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            font-family: 'Arial', sans-serif;
            line-height: 1.5;
            color: #333;
            background-color: #f9f9f9;
            display: flex;
            flex-direction: column;
            min-height: 100vh;
            width: 100%;
            overflow-x: hidden;
        }

        .container {
            width: 100%;
            max-width: 100%;
            padding: 0 15px;
            margin: 0 auto;
        }

        header {
            background-color: #006400;
            color: white;
            padding: 15px 0;
            text-align: center;
            width: 100%;
        }

        header h1 {
            font-size: clamp(1.4rem, 5vw, 1.8rem);
            margin: 0 auto;
            padding: 0 15px;
            line-height: 1.3;
        }

        main {
            flex: 1;
            width: 100%;
            padding: 15px 0;
        }

        section {
            width: 100%;
            margin-bottom: 20px;
            padding: 15px;
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .hero {
            text-align: center;
            margin-bottom: 20px;
        }

        .hero p {
            font-size: clamp(1rem, 3.5vw, 1.2rem);
            margin-bottom: 15px;
        }

        .hero img {
            max-width: 80%;
            height: auto;
            border-radius: 8px;
            margin: 0 auto;
            display: block;
        }

        .beneficios h2 {
            font-size: clamp(1.3rem, 4vw, 1.5rem);
            margin-bottom: 15px;
            color: #2E8B57;
        }

        .beneficios ul {
            list-style: none;
            padding-left: 20px;
        }

        .beneficios li {
            margin-bottom: 10px;
            position: relative;
            padding-left: 30px;
            font-size: clamp(0.95rem, 3vw, 1.1rem);
        }

        .beneficios li:before {
            content: "‚úî";
            color: #2E8B57;
            position: absolute;
            left: 0;
            font-size: 1.2rem;
        }

        .testimonio-especialista h2 {
            font-size: clamp(1.3rem, 4vw, 1.5rem);
            margin-bottom: 15px;
        }

        .contenido-especialista {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 15px;
        }

        .contenido-especialista img {
            border-radius: 50%;
            border: 3px solid #2E8B57;
            width: 120px;
            height: 120px;
            object-fit: cover;
        }

        blockquote {
            font-style: italic;
            position: relative;
            padding-left: 20px;
            font-size: clamp(1rem, 3.5vw, 1.1rem);
        }

        blockquote:before {
            content: '"';
            font-size: 3rem;
            color: #2E8B57;
            opacity: 0.2;
            position: absolute;
            left: -10px;
            top: -20px;
        }

        cite {
            display: block;
            margin-top: 10px;
            font-weight: bold;
            font-style: normal;
            text-align: right;
        }

        .componentes {
            background-color: #ffecec;
        }

        .componentes h2 {
            font-size: clamp(1.3rem, 4vw, 1.5rem);
            margin-bottom: 15px;
        }

        .ingrediente {
            background-color: white;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 15px;
        }

        .ingrediente h3 {
            color: #2E8B57;
            font-size: clamp(1.1rem, 3.5vw, 1.25rem);
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .estudios {
            background-color: #E8F5E9;
            text-align: center;
            font-size: clamp(0.9rem, 3vw, 1rem);
        }

        .cta-llamada {
            text-align: center;
            margin-bottom: 15px;
        }

        .cta-llamada h2 {
            font-size: clamp(1.3rem, 4.5vw, 1.6rem);
            margin-bottom: 10px;
        }

        .descuento {
            color: #E63946;
            font-weight: bold;
            font-size: clamp(1.2rem, 4vw, 1.4rem);
            display: block;
            margin-top: 5px;
        }

        .precios {
            margin: 10px 0;
            font-size: clamp(1.1rem, 4vw, 1.4rem);
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 15px;
        }

        .precio-original {
            text-decoration: line-through;
            color: #888;
            font-size: clamp(1rem, 3.5vw, 1.2rem);
        }

        .precio-descuento {
            color: #E63946;
            font-weight: bold;
            font-size: clamp(1.2rem, 4.5vw, 1.6rem);
        }

        .urgente {
            background-color: #FFF3CD;
            padding: 10px;
            border-radius: 5px;
            text-align: center;
            margin: 15px 0;
            border-left: 4px solid #FFC107;
            font-size: clamp(0.9rem, 3vw, 1rem);
        }

        form {
            width: 100%;
            max-width: 400px;
            margin: 20px auto 0;
        }

        .input-group {
            margin-bottom: 15px;
        }

        label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
            font-size: clamp(0.95rem, 3vw, 1.05rem);
        }

        input {
            width: 100%;
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 6px;
            font-size: clamp(1rem, 3.5vw, 1.1rem);
        }

        button {
            background-color: #2E8B57;
            color: white;
            padding: 15px;
            border: none;
            border-radius: 6px;
            font-size: clamp(1rem, 3.5vw, 1.1rem);
            font-weight: bold;
            width: 100%;
            margin-top: 10px;
            cursor: pointer;
            transition: all 0.3s;
        }

        button:hover {
            background-color: #1e6b3e;
        }

        button:disabled {
            background-color: #aaa;
            cursor: not-allowed;
        }

        .legal {
            font-size: clamp(0.75rem, 2.5vw, 0.85rem);
            color: #666;
            text-align: center;
            margin-top: 15px;
        }

        .testimonios-reales h2 {
            font-size: clamp(1.3rem, 4vw, 1.5rem);
            text-align: center;
            margin-bottom: 20px;
        }

        .grid-testimonios {
            display: grid;
            grid-template-columns: 1fr;
            gap: 15px;
        }

        .testimonio-card {
            background-color: #fafafa;
            padding: 15px;
            border-radius: 8px;
            border: 1px solid #eee;
        }

        .cliente-info {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 10px;
        }

        .cliente-info img {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            border: 2px solid #2E8B57;
            object-fit: cover;
        }

        .ubicacion {
            font-size: clamp(0.8rem, 2.8vw, 0.9rem);
            color: #666;
        }

        .fecha {
            font-size: clamp(0.75rem, 2.5vw, 0.85rem);
            color: #999;
            text-align: right;
            margin-top: 10px;
        }

        .verificado {
            font-size: clamp(0.8rem, 2.8vw, 0.9rem);
            color: #666;
            text-align: center;
            margin-top: 15px;
        }

        footer {
            background-color: #333;
            color: white;
            text-align: center;
            padding: 15px;
            margin-top: 20px;
            font-size: clamp(0.9rem, 3vw, 1rem);
        }

        @media (min-width: 768px) {
            .container {
                max-width: 750px;
            }
            
            .contenido-especialista {
                flex-direction: row;
                align-items: flex-start;
                text-align: left;
            }
            
            .grid-testimonios {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        .ruleta-container {
            text-align: center;
            margin: 20px 0;
            padding: 20px;
            background: linear-gradient(135deg, #fff8f8, #fff);
            border-radius: 10px;
            border: 2px dashed #dd3131;
            position: relative;
            transition: all 0.5s ease;
        }

        .ruleta-oculta {
            opacity: 0;
            height: 0;
            padding: 0;
            margin: 0;
            overflow: hidden;
            border: none;
        }

        .ruleta-wrapper {
            position: relative;
            width: 260px;
            height: 260px;
            margin: 0 auto 20px;
        }

        .ruleta {
            width: 100%;
            height: 100%;
            position: relative;
            border-radius: 50%;
            overflow: hidden;
            box-shadow: 0 0 20px rgba(0,0,0,0.15);
            transition: transform 4s cubic-bezier(0.17, 0.67, 0.12, 0.99);
        }

        .ruleta-segmento {
            position: absolute;
            width: 50%;
            height: 50%;
            transform-origin: bottom right;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            color: white;
            font-size: 1.3rem;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.3);
        }

        .ruleta-flecha {
            position: absolute;
            top: -15px;
            left: 50%;
            transform: translateX(-50%) rotate(36deg);
            width: 0;
            height: 0;
            border-left: 20px solid transparent;
            border-right: 20px solid transparent;
            border-top: 35px solid #dd3131;
            z-index: 20;
            filter: drop-shadow(0 2px 2px rgba(0,0,0,0.2));
        }

        .ruleta-centro {
            position: absolute;
            width: 40px;
            height: 40px;
            background: white;
            border-radius: 50%;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            z-index: 15;
            border: 3px solid #dd3131;
            box-shadow: 0 0 10px rgba(0,0,0,0.2);
        }

        .segmento-10 { background: #FF5252; transform: rotate(0deg); }
        .segmento-20 { background: #4CAF50; transform: rotate(72deg); }
        .segmento-30 { background: #FFC107; transform: rotate(144deg); }
        .segmento-40 { background: #2196F3; transform: rotate(216deg); }
        .segmento-50 { background: #dd3131; transform: rotate(288deg); }

        .ruleta-boton {
            background-color: #dd3131;
            color: white;
            border: none;
            padding: 12px 30px;
            font-size: 1.2rem;
            border-radius: 50px;
            margin-top: 10px;
            cursor: pointer;
            font-weight: bold;
            box-shadow: 0 4px 10px rgba(0,0,0,0.2);
            transition: all 0.3s;
        }

        .ruleta-boton:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 15px rgba(0,0,0,0.3);
            background-color: #c62828;
        }

        .resultado-descuento {
            display: none;
            font-size: clamp(1.3rem, 5vw, 1.8rem);
            font-weight: bold;
            color: #dd3131;
            margin: 20px 0;
            animation: fadeIn 1s;
            padding: 10px;
            background-color: rgba(255, 255, 255, 0.8);
            border-radius: 8px;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .form-status {
            display: none;
            padding: 15px;
            margin: 15px 0;
            border-radius: 5px;
            text-align: center;
            font-weight: bold;
        }
        
        .form-loading {
            background-color: #e2f3ff;
            color: #004085;
        }
        
        .form-success {
            background-color: #d4edda;
            color: #155724;
        }
        
        .form-error {
            background-color: #f8d7da;
            color: #721c24;
        }
        
        .form-status i {
            margin-right: 8px;
        }
        
        @media (max-width: 480px) {
            input, button {
                padding: 14px;
                font-size: 1rem;
            }
            
            .ruleta-wrapper {
                width: 220px;
                height: 220px;
            }
            
            .form-status {
                padding: 12px;
                font-size: 0.9rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>FlexDol: Bienestar y Alivio Articular 100% Natural</h1>
        </header>
        
        <main>
            <section class="hero">
                <p>Mejora tu calidad de vida al aliviar molestias articulares de forma natural, sin efectos secundarios.</p>
                <img src="https://i.imgur.com/l4HfkDl.png" alt="Envase de FlexDol - Suplemento para articulaciones">
            </section>

            <section class="beneficios">
                <h2>Beneficios Cl√≠nicamente Comprobados</h2>
                <ul>
                    <li> Alivio r√°pido del dolor articular</li>
                    <li> F√≥rmula 100% natural sin qu√≠micos</li>
                    <li> Mejora la movilidad en todas las edades</li>
                    <li> Fortalece cart√≠lagos y articulaciones</li>
                </ul>
            </section>

            <section class="testimonio-especialista">
                <h2>Doctor Arturo Segovia <small>(Especialista en Ortopedia)</small></h2>
                <div class="contenido-especialista">
                    <img src="https://i.imgur.com/4rbxF7x.png" alt="Doctor Arturo Segovia">
                    <div>
                        <blockquote>
                            <p>"El dolor articular afecta al <strong>85% de personas mayores de 40 a√±os</strong> debido al desgaste natural del cart√≠lago. La mayor√≠a de tratamientos contienen qu√≠micos agresivos, pero <strong>FlexDol</strong> combina ingredientes naturales como <em>col√°geno</em> y <em>c√∫rcuma</em>, que reducen la inflamaci√≥n sin da√±ar el h√≠gado o los ri√±ones."</p>
                            <cite>‚Äî Dr. Arturo Segovia, 15 a√±os de experiencia.</cite>
                        </blockquote>
                    </div>
                </div>
            </section>

            <section class="componentes">
                <h2>¬øQu√© contiene FlexDol?</h2>
                <div class="ingrediente">
                    <h3>üåü Col√°geno</h3>
                    <p>Regenera los tejidos cartilaginosos y mejora la flexibilidad articular.</p>
                </div>
                <div class="ingrediente">
                    <h3>üåø C√∫rcuma</h3>
                    <p>Antiinflamatorio natural que reduce el dolor y la rigidez.</p>
                </div>
                <div class="ingrediente">
                    <h3>üíß Jengibre</h3>
                    <p>Ayuda a reducir la inflamaci√≥n en las articulaciones, aliviando el dolor de forma natural.</p>
                </div>
            </section>

            <section class="estudios">
                <p><strong>Estudio cl√≠nico:</strong> 78% de pacientes reportaron menos dolor en 4 semanas.</p>
            </section>

            <section class="oferta">
                <div class="ruleta-container" id="contenedor-ruleta">
                    <h2 class="ruleta-titulo">¬°GIRA LA RULETA POR TU DESCUENTO EXCLUSIVO!</h2>
                    <div class="ruleta-wrapper">
                        <div class="ruleta-flecha"></div>
                        <div class="ruleta" id="ruleta">
                            <div class="ruleta-segmento segmento-10">10%</div>
                            <div class="ruleta-segmento segmento-20">20%</div>
                            <div class="ruleta-segmento segmento-30">30%</div>
                            <div class="ruleta-segmento segmento-40">40%</div>
                            <div class="ruleta-segmento segmento-50">50%</div>
                        </div>
                        <div class="ruleta-centro"></div>
                    </div>
                    <button class="ruleta-boton" id="girar-ruleta">¬°GIRAR AHORA!</button>
                    <div class="resultado-descuento" id="resultado-descuento">
                        ¬°FELICIDADES! GANASTE <span id="descuento-ganado">50%</span> DE DESCUENTO üéâ
                    </div>
                </div>

                <div id="oferta-real" style="display: none;">
                    <div class="cta-llamada">
                        <h2>¬°LO LOGRASTE! Obtuviste <span class="descuento">50% DE DESCUENTO</span></h2>
                        <div class="precios">
                            <span class="precio-original">$100.000 COP</span>
                            <span class="precio-descuento">$50.000 COP</span>
                        </div>
                        <p>Esta oferta especial est√° reservada solo para ti</p>
                    </div>
                    
                    <div class="urgente">
                        <p>‚ö†Ô∏è <strong>OFERTA POR TIEMPO LIMITADO!</strong> Solo por hoy</p>
                    </div>

                    <form id="form-llamada">
                        <input type="hidden" name="access_key" value="d7c9e9b0-7e1e-4b3e-9e9a-1b1b1b1b1b1b">
                        <input type="hidden" name="fuente" value="landing-flexdol">
                        <input type="hidden" name="descuento" value="50%">
                        
                        <div class="input-group">
                            <label for="nombre">Nombre completo*:</label>
                            <input type="text" id="nombre" name="nombre" required placeholder="Tu nombre completo">
                        </div>
                        
                        <div class="input-group">
                            <label for="telefono">Tel√©fono*:</label>
                            <input type="tel" id="telefono" name="telefono" required 
                                   placeholder="Ej: 3001234567" pattern="[0-9]{7,15}" 
                                   title="M√≠nimo 7 d√≠gitos" inputmode="numeric">
                        </div>
                        
                        <button type="submit" id="submit-btn">
                            <span id="btn-text">‚úÖ ¬°QUIERO MI 50% DE DESCUENTO!</span>
                            <span id="btn-loading" style="display:none;">
                                <i class="fas fa-spinner fa-spin"></i> Enviando...
                            </span>
                        </button>
                        
                        <div id="form-messages">
                            <div id="form-success" class="form-status form-success" style="display:none;">
                                <i class="fas fa-check-circle"></i> ¬°Recibido! Te llamaremos pronto.
                            </div>
                            <div id="form-error" class="form-status form-error" style="display:none;">
                                <i class="fas fa-exclamation-triangle"></i> <span id="error-text">Error al enviar</span>
                            </div>
                        </div>
                        
                        <p class="legal">Al enviar aceptas nuestra <a href="politica-de-privacidad.html" target="_blank">Pol√≠tica de Privacidad</a>.</p>
                    </form>
                </div>
            </section>

            <section class="testimonios-reales">
                <h2>Lo que dicen nuestros clientes</h2>
                
                <div class="grid-testimonios">
                    <div class="testimonio-card">
                        <div class="cliente-info">
                            <img src="https://i.imgur.com/CImc7sQ.jpeg" alt="Cliente 1">
                            <div>
                                <h4>Marta G√≥mez</h4>
                                <p class="ubicacion">Bogot√°, Colombia ‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ</p>
                            </div>
                        </div>
                        <blockquote>
                            <p>"Despu√©s de 3 meses usando FlexDol, puedo subir escaleras sin dolor. ¬°A mi edad me siento como nueva!"</p>
                            <div class="fecha">Publicado hace 2 semanas</div>
                        </blockquote>
                    </div>
            
                    <div class="testimonio-card">
                        <div class="cliente-info">
                            <img src="https://i.imgur.com/kOlgbvT.png" alt="Cliente 2">
                            <div>
                                <h4>Carlos Rojas</h4>
                                <p class="ubicacion">Medell√≠n, Colombia ‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ</p>
                            </div>
                        </div>
                        <blockquote>
                            <p>"Soy carpintero y el dolor en mis manos era insoportable. En 15 d√≠as empec√© a notar la diferencia. ¬°Totalmente recomendado!"</p>
                            <div class="fecha">Publicado hace 15 dias</div>
                        </blockquote>
                    </div>
                </div>
            
                <div class="verificado">
                    <span>Testimonios 100% reales verificados por nuestros clientes</span>
                </div>
            </section>
        </main>

        <footer>
            <p>¬© 2025 FlexDol. Todos los derechos reservados.</p>
        </footer>
    </div>

    <!-- P√°gina de confirmaci√≥n -->
    <div id="confirmation-page" style="display: none;">
        <div class="card">
            <h1>¬°Gracias! ¬°Tu pedido ha sido aceptado!</h1>
            <p>Un miembro de nuestro equipo se pondr√° en contacto contigo en breve para confirmar tu pedido.</p>
            
            <p><span class="destacado">Nombre:</span> <span id="confirm-name"></span></p>
            <p><span class="destacado">Tel√©fono:</span> <span id="confirm-phone"></span></p>
            
            <p>üîî Verifica que los datos sean correctos.</p>
            <p>üì± ¬°Por favor, mant√©n tu tel√©fono encendido!</p>
            <p>üíµ El pago se realiza al recibir el producto.</p>

            <div class="img-row">
              <img src="https://artralon-store.com/co/img/hset.png" alt="Aud√≠fonos">
              <img src="https://artralon-store.com/co/img/pment.png" alt="Pago">
              <img src="https://artralon-store.com/co/img/mob.png" alt="Tel√©fono m√≥vil">
            </div>

            <div class="footer">FlexDol Salud Articular ‚Ä¢ Colombia</div>
        </div>
    </div>

    <!-- JavaScript mejorado -->
    <script>
        // CONFIGURACI√ìN PRINCIPAL - REEMPLAZAR CON TUS DATOS
        const WHATSAPP_NUMBER = '573001234567'; // Tu n√∫mero con c√≥digo de pa√≠s
        const WEB3FORMS_KEY = 'd7c9e9b0-7e1e-4b3e-9e9a-1b1b1b1b1b1b'; // Tu API key de web3forms
        
        // ENDPOINTS DE ENV√çO (3 m√©todos diferentes)
        const FORM_ENDPOINTS = [
            {
                url: `https://api.web3forms.com/submit`,
                method: 'POST',
                params: {
                    access_key: WEB3FORMS_KEY,
                    subject: 'Nuevo lead FlexDol',
                    from_name: 'Landing Page'
                }
            },
            {
                url: 'https://formspree.io/f/mvojzqzl',
                method: 'POST'
            },
            {
                url: 'https://script.google.com/macros/s/AKfycbz6XgQ7J7ZWGQ6hQ5J7X9X6X6X6X6X6X6X6X6X6X6X6X6X6X6X6X6/exec',
                method: 'GET'
            }
        ];

        // ELEMENTOS DEL DOM
        const form = document.getElementById('form-llamada');
        const submitBtn = document.getElementById('submit-btn');
        const btnText = document.getElementById('btn-text');
        const btnLoading = document.getElementById('btn-loading');
        const successMsg = document.getElementById('form-success');
        const errorMsg = document.getElementById('form-error');
        const errorText = document.getElementById('error-text');
        const confirmationPage = document.getElementById('confirmation-page');
        const confirmName = document.getElementById('confirm-name');
        const confirmPhone = document.getElementById('confirm-phone');

        // MANEJADOR DEL FORMULARIO
        form.addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const nombre = form.nombre.value.trim();
            const telefono = form.telefono.value.trim();
            
            // Validaci√≥n mejorada para m√≥viles
            if (!nombre || nombre.length < 3) {
                showError('Por favor ingresa tu nombre completo');
                return;
            }
            
            if (!telefono || !/^[0-9]{7,15}$/.test(telefono)) {
                showError('Por favor ingresa un n√∫mero v√°lido (7-15 d√≠gitos)');
                return;
            }
            
            startLoading();
            
            try {
                const success = await sendFormData(nombre, telefono);
                
                if (success) {
                    showConfirmationPage(nombre, telefono);
                    form.reset();
                    localStorage.removeItem('unsent_form_data');
                } else {
                    showError('Error al enviar. Por favor intenta nuevamente m√°s tarde.');
                }
            } catch (error) {
                console.error('Error cr√≠tico:', error);
                showError('Error inesperado. Por favor cont√°ctanos por WhatsApp.');
                saveDataLocally(nombre, telefono);
            } finally {
                stopLoading();
            }
        });

        // FUNCI√ìN PRINCIPAL DE ENV√çO
        async function sendFormData(nombre, telefono) {
            const formData = {
                nombre: nombre,
                telefono: telefono,
                fecha: new Date().toLocaleString(),
                origen: 'landing-flexdol',
                descuento: '50%'
            };

            // 1. Intentar con todos los endpoints
            for (const endpoint of FORM_ENDPOINTS) {
                try {
                    let url = endpoint.url;
                    let options = {
                        method: endpoint.method,
                        headers: endpoint.headers || {}
                    };
                    
                    // Preparar datos seg√∫n el m√©todo
                    if (endpoint.method === 'GET') {
                        const params = new URLSearchParams({...endpoint.params, ...formData});
                        url = `${url}?${params}`;
                    } else {
                        options.headers['Content-Type'] = 'application/json';
                        options.body = JSON.stringify({...endpoint.params, ...formData});
                    }
                    
                    const response = await fetchWithTimeout(url, options, 8000);
                    
                    if (response.ok) return true;
                } catch (error) {
                    console.log(`Error con ${endpoint.url}:`, error);
                }
            }
            
            // 2. Si todo falla, usar WhatsApp como √∫ltimo recurso
            try {
                const whatsappUrl = `https://wa.me/${WHATSAPP_NUMBER}?text=${encodeURIComponent(
                    `Hola, quiero mi descuento de FlexDol. Mi nombre es ${nombre} y mi tel√©fono es ${telefono}`
                )}`;
                
                window.open(whatsappUrl, '_blank');
                return true;
            } catch (error) {
                console.log('Error con WhatsApp:', error);
                return false;
            }
        }

        // FUNCI√ìN FETCH CON TIMEOUT
        async function fetchWithTimeout(url, options = {}, timeout = 8000) {
            const controller = new AbortController();
            const timeoutId = setTimeout(() => controller.abort(), timeout);
            
            try {
                const response = await fetch(url, {
                    ...options,
                    signal: controller.signal
                });
                
                clearTimeout(timeoutId);
                return response;
            } catch (error) {
                clearTimeout(timeoutId);
                throw error;
            }
        }

        // MOSTRAR P√ÅGINA DE CONFIRMACI√ìN
        function showConfirmationPage(nombre, telefono) {
            confirmName.textContent = nombre;
            confirmPhone.textContent = telefono;
            
            document.querySelector('.container').style.display = 'none';
            confirmationPage.style.display = 'block';
            document.title = "Pedido Confirmado - FlexDol";
            
            // Scroll al inicio
            window.scrollTo(0, 0);
        }

        // FUNCIONES AUXILIARES
        function startLoading() {
            btnText.style.display = 'none';
            btnLoading.style.display = 'inline';
            submitBtn.disabled = true;
            successMsg.style.display = 'none';
            errorMsg.style.display = 'none';
        }

        function stopLoading() {
            btnText.style.display = 'inline';
            btnLoading.style.display = 'none';
            submitBtn.disabled = false;
        }

        function showError(message) {
            errorText.innerHTML = message;
            errorMsg.style.display = 'block';
            successMsg.style.display = 'none';
            errorMsg.scrollIntoView({ behavior: 'smooth', block: 'center' });
        }

        function saveDataLocally(nombre, telefono) {
            const formData = {
                nombre: nombre,
                telefono: telefono,
                timestamp: new Date().toISOString()
            };
            localStorage.setItem('unsent_form_data', JSON.stringify(formData));
        }

        // VERIFICAR DATOS NO ENVIADOS AL CARGAR
        window.addEventListener('load', () => {
            const unsentData = localStorage.getItem('unsent_form_data');
            if (unsentData) {
                try {
                    const data = JSON.parse(unsentData);
                    const hoursSinceSave = (new Date() - new Date(data.timestamp)) / (1000 * 60 * 60);
                    
                    if (hoursSinceSave < 24) {
                        showError(`
                            Tenemos datos no enviados desde ${new Date(data.timestamp).toLocaleTimeString()}. 
                            <a href="javascript:resendData()" style="color: #2E8B57; font-weight: bold;">Reintentar env√≠o</a>
                        `);
                    } else {
                        localStorage.removeItem('unsent_form_data');
                    }
                } catch (e) {
                    localStorage.removeItem('unsent_form_data');
                }
            }
        });

        // REINTENTAR ENV√çO
        window.resendData = async function() {
            const unsentData = localStorage.getItem('unsent_form_data');
            if (!unsentData) return;
            
            try {
                const data = JSON.parse(unsentData);
                form.nombre.value = data.nombre;
                form.telefono.value = data.telefono;
                
                showError('Reintentando env√≠o...');
                form.dispatchEvent(new Event('submit'));
                
            } catch (e) {
                localStorage.removeItem('unsent_form_data');
                showError('Error al recuperar datos. Por favor completa el formulario nuevamente.');
            }
        };

        // RULETA DE DESCUENTO
        document.getElementById('girar-ruleta').addEventListener('click', function() {
            const ruleta = document.getElementById('ruleta');
            const contenedorRuleta = document.getElementById('contenedor-ruleta');
            const resultado = document.getElementById('resultado-descuento');
            const oferta = document.getElementById('oferta-real');
            const boton = this;
            
            boton.disabled = true;
            boton.textContent = 'Girando...';
            
            const anguloFinal = 1440 + (Math.floor(Math.random() * 5) * 72) + 36;
            
            ruleta.style.transform = `rotate(${-anguloFinal}deg)`;
            ruleta.style.transition = 'transform 4s cubic-bezier(0.17, 0.67, 0.12, 0.99)';
            
            setTimeout(() => {
                const segmentos = [50, 10, 40, 20, 30];
                const segmentoGanador = segmentos[Math.floor((anguloFinal % 360) / 72)];
                document.getElementById('descuento-ganado').textContent = segmentoGanador + '%';
                document.querySelector('input[name="descuento"]').value = segmentoGanador + '%';
                
                resultado.style.display = 'block';
                
                setTimeout(() => {
                    contenedorRuleta.classList.add('ruleta-oculta');
                    oferta.style.display = 'block';
                    oferta.scrollIntoView({ behavior: 'smooth' });
                }, 1000);
                
            }, 3500);
        });

        // MEJORAS PARA M√ìVILES
        document.addEventListener('DOMContentLoaded', function() {
            if ('maxTouchPoints' in navigator && navigator.maxTouchPoints > 0) {
                const inputs = document.querySelectorAll('input[type="text"], input[type="tel"]');
                inputs.forEach(input => {
                    input.addEventListener('focus', function() {
                        setTimeout(() => {
                            window.scrollTo(0, this.getBoundingClientRect().top + window.pageYOffset - 100);
                        }, 100);
                    });
                });
            }
        });
    </script>
</body>
</html>
